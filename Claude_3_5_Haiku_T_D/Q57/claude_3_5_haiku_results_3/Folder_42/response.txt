Message(id='msg_01NLDh842i95ZPrpzvJLgoci', content=[TextBlock(text="Here's the Python implementation:\n\n```python\nimport numpy as np\n\ndef submatrix_with_particular_sum(matrix):\n    rows, cols = matrix.shape\n    result = []\n\n    for r1 in range(rows):\n        for r2 in range(r1, rows):\n            for c1 in range(cols):\n                for c2 in range(c1, cols):\n                    submatrix = matrix[r1:r2+1, c1:c2+1]\n                    if np.sum(submatrix) == 862:\n                        result.append(submatrix.tolist())\n\n    return result\n```\n\nThis implementation works as follows:\n\n1. It uses nested loops to generate all possible submatrices of the input matrix.\n2. The loops iterate through possible start and end rows (r1, r2) and columns (c1, c2).\n3. Each submatrix is extracted using NumPy array slicing.\n4. If the sum of the submatrix equals 862, it's converted to a list and added to the results.\n5. Finally, the list of submatrices with a sum of 862 is returned.\n\nNote that the function requires NumPy and will work with a NumPy matrix input.", type='text')], model='claude-3-5-haiku-20241022', role='assistant', stop_reason='end_turn', stop_sequence=None, type='message', usage=Usage(input_tokens=140, output_tokens=297))