Message(id='msg_01DnnA9FN6e5skAMUsx419FG', content=[TextBlock(text="Here's the Python implementation:\n\n```python\nimport numpy as np\n\ndef submatrix_with_n_numbers(matrix):\n    rows, cols = matrix.shape\n    count = 0\n    \n    for h1 in range(rows):\n        for h2 in range(h1, rows):\n            for w1 in range(cols):\n                for w2 in range(w1, cols):\n                    submatrix = matrix[h1:h2+1, w1:w2+1]\n                    if submatrix.size == 99:\n                        count += 1\n    \n    return count\n```\n\nThis function does the following:\n\n1. It takes a numpy matrix as input.\n2. It determines the number of rows and columns in the matrix.\n3. It initializes a counter for submatrices.\n4. It uses nested loops to generate all possible submatrices:\n   - `h1` and `h2` define the vertical range\n   - `w1` and `w2` define the horizontal range\n5. For each submatrix, it checks if the total number of elements is exactly 99.\n6. If a submatrix contains 99 elements, it increments the counter.\n7. Finally, it returns the total count of submatrices with 99 elements.\n\nThe function works with numpy matrices and efficiently checks all possible submatrices.", type='text')], model='claude-3-5-haiku-20241022', role='assistant', stop_reason='end_turn', stop_sequence=None, type='message', usage=Usage(input_tokens=131, output_tokens=326))