Message(id='msg_01HAsNntz2KMPguVQDZ6ZKCT', content=[TextBlock(text="Here's the Python implementation for the specified function:\n\n```python\nimport numpy as np\n\ndef submatrix_with_n_numbers(matrix):\n    rows, cols = matrix.shape\n    count = 0\n\n    for r1 in range(rows):\n        for r2 in range(r1, rows):\n            for c1 in range(cols):\n                for c2 in range(c1, cols):\n                    submatrix = matrix[r1:r2+1, c1:c2+1]\n                    if submatrix.size == 131:\n                        count += 1\n\n    return count\n```\n\nThis implementation does the following:\n\n1. It takes a 2D NumPy matrix as input.\n2. It gets the number of rows and columns in the matrix.\n3. It initializes a counter for submatrices.\n4. It uses nested loops to generate all possible submatrices:\n   - `r1` and `r2` define the row range\n   - `c1` and `c2` define the column range\n5. For each submatrix:\n   - It extracts the submatrix using numpy's slicing\n   - It checks if the size of the submatrix is exactly 131\n   - If so, it increments the count\n6. Finally, it returns the total count of submatrices with 131 integers.\n\nThe function will work with any 2D NumPy matrix of integers and efficiently count submatrices with exactly 131 elements.", type='text')], model='claude-3-5-haiku-20241022', role='assistant', stop_reason='end_turn', stop_sequence=None, type='message', usage=Usage(input_tokens=131, output_tokens=354))