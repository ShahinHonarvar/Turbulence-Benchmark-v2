id='0e11e1115fd2414b9ec79c8fddbced54' object='chat.completion' model='mistral-large-latest' usage=UsageInfo(prompt_tokens=133, completion_tokens=300, total_tokens=433) created=1730479809 choices=[ChatCompletionChoice(index=0, message=AssistantMessage(content="```python\nimport numpy as np\n\ndef submatrix_with_n_numbers(matrix):\n    m, n = matrix.shape\n    count = 0\n\n    def count_submatrices(matrix, m, n, num):\n        dp = np.zeros((m, n), dtype=int)\n        for i in range(m):\n            for j in range(n):\n                if matrix[i][j] == num:\n                    dp[i][j] = 0\n                else:\n                    dp[i][j] = 1 + (dp[i-1][j] if i > 0 else 0)\n\n        submatrix_count = 0\n        for i in range(m):\n            for j in range(n):\n                min_height = float('inf')\n                for k in range(j, -1, -1):\n                    min_height = min(min_height, dp[i][k])\n                    if min_height * (j - k + 1) == num:\n                        submatrix_count += 1\n\n        return submatrix_count\n\n    for num in np.unique(matrix):\n        count += count_submatrices(matrix, m, n, num)\n\n    return count\n```", tool_calls=None, prefix=False, role='assistant'), finish_reason='stop')]